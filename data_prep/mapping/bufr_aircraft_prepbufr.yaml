bufr: 
  group_by_variable: driftLatitude

  subsets:
    - AIRCAR
    - AIRCFT

  variables:
    # MetaData

    stationIdentification:
      query: "*/SID"

    aircraftFlightNumber:
      query: "[*/ACID_SEQ/ACID, */ACID]"

    driftCycleTime:
      query: "*/PRSLEVLA/DRFTINFO/HRDR"

    driftLatitude:
      query: "*/PRSLEVLA/DRFTINFO/YDR"

    driftLongitude:
      query: "*/PRSLEVLA/DRFTINFO/XDR"
      transforms:
        - wrap: [ -180.0, 180.0 ]

    instantaneousAltitudeRate:
      query: "*/PRSLEVLA/IALR"

    # Observation Values

    airPressure:
      query: "*/PRSLEVLA/P___INFO/P__EVENT{1}/POB"

    airTemperature:
      query: "*/PRSLEVLA/T___INFO/T__EVENT{1}/TOB"

    height:
      query: "*/PRSLEVLA/Z___INFO/Z__EVENT{1}/ZOB"

    windU:
      query: "*/PRSLEVLA/W___INFO/W__EVENT{1}/UOB"

    windV:
      query: "*/PRSLEVLA/W___INFO/W__EVENT{1}/VOB"

    specificHumidity:
      query: "*/PRSLEVLA/Q___INFO/Q__EVENT{1}/QOB"
      type: float
      transforms:
        - scale: 0.000001  # Convert from mg/kg to kg/kg 

    #Quality Indicators

    airPressureQuality:
      query: "*/PRSLEVLA/P___INFO/P__EVENT{1}/PQM"

    airTemperatureQuality:
      query: "*/PRSLEVLA/T___INFO/T__EVENT{1}/TQM"

    heightQuality:
      query: "*/PRSLEVLA/Z___INFO/Z__EVENT{1}/ZQM"
    
    windQuality:
      query: "*/PRSLEVLA/W___INFO/W__EVENT{1}/WQM"

    specificHumidityQuality:
      query: "*/PRSLEVLA/Q___INFO/Q__EVENT{1}/QQM"

encoder:

  variables:
    # MetaData
    - name: "stationIdentification"
      source: variables/stationIdentification
      longName: "Station Identification"

    - name: "aircraftFlightNumber"
      source: variables/aircraftFlightNumber
      longName: "Aircraft Flight Number"

    - name: "instantaneousAltitudeRate"
      source: variables/instantaneousAltitudeRate
      longName: "Instantaneous Altitude Rate"
      units: "m/s"

    - name: "latitude"
      source: variables/driftLatitude
      longName: "Latitude"
      units: "degree_north"
      range: [-90, 90]

    - name: "longitude"
      source: variables/driftLongitude
      longName: "Longitude"
      units: "degree_east"
      range: [-180, 180]

    # Observation Values
    - name: "airPressure"
      source: variables/airPressure
      longName: "Air Pressure at Station Level"
      units: "hPa"

    - name: "airTemperature"
      source: variables/airTemperature
      longName: "Air Temperature at Station Level"
      units: "C"

    - name: "height"
      source: variables/height
      longName: "Height at Station Level"
      units: "m"

    - name: "windU"
      source: variables/windU
      longName: "U-component of Wind at Station Level"
      units: "m/s"

    - name: "windV"
      source: variables/windV
      longName: "V-component of Wind at Station Level"
      units: "m/s"
  
    - name: "specificHumidity"
      source: variables/specificHumidity
      longName: "Specific Humidity at Station Level"
      units: "kg/kg"
    
    #Quality Indicators
    - name: "airPressureQuality"
      source: variables/airPressureQuality
      longName: "Air Pressure Quality Indicator"

    - name: "airTemperatureQuality"
      source: variables/airTemperatureQuality
      longName: "Air Temperature Quality Indicator" 

    - name: "heightQuality"
      source: variables/heightQuality
      longName: "Height Quality Indicator"  

    - name: "windQuality"
      source: variables/windQuality
      longName: "Wind Quality Indicator"

    - name: "specificHumidityQuality"
      source: variables/specificHumidityQuality
      longName: "Specific Humidity Quality Indicator" 
    
