bufr:
  subsets:
    - ADPSFC
    - SFCSHP
  variables:
    obsTimeMinusCycleTime:
      query: "*/DHR"

    latitude:
      query: "*/YOB"

    longitude:
      query: "*/XOB"
      transforms:
        - wrap: [ -180.0, 180.0 ]

    height_prepbufr:
      query: "*/Z___INFO/Z__EVENT/ZOB"

    stationElevation_prepbufr:
      query: "*/ELV"

    pressureMeanSeaLevel_prepbufr:
      query: "*/PMSL_SEQ/PMO"

    airPressure_prepbufr:
      query: "*/P___INFO/P__EVENT{1-3}/POB"

    eastwardWind:
      query: "*/W___INFO/W__EVENT/UOB"

    northwardWind:
      query: "*/W___INFO/W__EVENT/VOB"

    specificHumidity:
      query: "*/Q___INFO/Q__EVENT/QOB"
      type: float
      transforms:
        - scale: 0.000001    # convert g/kg to kg/kg

    # Quality Markers
    airTemperatureQuality:
      query: "*/T___INFO/T__EVENT/TQM"

    specificHumidityQuality:
      query: "*/Q___INFO/Q__EVENT/QQM"

    dewPointTemperatureQuality:
      query: "*/Q___INFO/Q__EVENT/QQM"

    airPressureQuality:
      query: "*/P___INFO/P__EVENT{1-3}/PQM" # coarse dimension

    heightQuality:
      query: "*/Z___INFO/Z__EVENT/ZQM"

    windQuality:
      query: "*/W___INFO/W__EVENT/WQM"



encoder:
  variables:
    # MetaData
    - name: "latitude"
      source: variables/latitude
      longName: "Latitude"
      units: "degree_north"
      range: [-90, 90]

    - name: "longitude"
      source: variables/longitude
      longName: "Longitude"
      units: "degree_east"

    - name: "height_prepbufr"
      source: variables/height_prepbufr
      longName: "height from prepbufr (ZOB)"
      units: "m"

    - name: "stationElevation_prepbufr"
      source: variables/stationElevation_prepbufr
      longName: "stationElevation from prepbufr (ELV)"
      units: "m"

    - name: "airPressure_prepbufr"
      source: variables/airPressure_prepbufr
      longName: "airPressure from pb (POB)"
      units: "hPa"

    - name: "pressureMeanSeaLevel_prepbufr"
      source: variables/pressureMeanSeaLevel_prepbufr
      longName: "pressureMeanSeaLevel from pb (PMO)"
      units: "hPa"

    - name: "airTemperatureQuality"
      source: variables/airTemperatureQuality
      longName: "Air Temperature Quality Marker"
        #units: "quality_marker"

    - name: "specificHumidityQuality"
      source: variables/specificHumidityQuality
      longName: "Specific Humidity Quality Marker"
        #units: "quality_marker"

    - name: "dewPointTemperatureQuality"
      source: variables/dewPointTemperatureQuality
      longName: "Dew Point Temperature Quality Marker"
        #units: "quality_marker"

    - name: "windQuality"
      source: variables/windQuality
      longName: "Wind Quality Marker"
        #units: "quality_marker"

    - name: "airPressureQuality"
      source: variables/airPressureQuality
      longName: "Air Pressure Quality Marker"
        #units: "quality_marker"

    - name: "heightQuality"
      source: variables/heightQuality
      longName: "Height Quality Marker"
        #units: "quality_marker"
